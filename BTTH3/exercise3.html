<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài tập 3 - Website tính tiền món ăn nhà hàng</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            background-color: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .header h1 {
            margin: 0;
            font-size: 18px;
        }
        .header p {
            margin: 5px 0;
            font-size: 14px;
        }
        .menu-section {
            margin: 20px 0;
        }
        .menu-section h3 {
            background-color: #2196F3;
            color: white;
            padding: 10px;
            margin: 0 0 10px 0;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        .delete-btn {
            background-color: #f44336;
        }
        .delete-btn:hover {
            background-color: #da190b;
        }
        .print-btn {
            background-color: #2196F3;
            padding: 15px 30px;
            font-size: 16px;
            display: block;
            margin: 20px auto;
        }
        .print-btn:hover {
            background-color: #1976D2;
        }
        .order-section {
            margin: 20px 0;
        }
        .table-section {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
        .table-section h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .order-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            padding: 5px;
            background-color: white;
            border-radius: 3px;
        }
        .order-item input {
            width: 60px;
            margin: 0 5px;
            padding: 3px;
        }
        .pricing-info {
            background-color: #e8f5e8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Thứ 2, 06/07/2020, 11:00</h1>
            <p>Nhân viên: Nguyễn Văn A</p>
        </div>

        <div class="menu-section">
            <h3>THỰC ĐƠN</h3>
            <table>
                <tr>
                    <th>Bàn</th>
                    <th>Món ăn</th>
                </tr>
                <tr>
                    <td>
                        <select id="tableSelect">
                            <option value="1">Bàn 1</option>
                            <option value="2">Bàn 2</option>
                            <option value="3">Bàn 3</option>
                        </select>
                    </td>
                    <td>
                        <select id="dishSelect" multiple size="7">
                            <option value="bunbo">Bún bò</option>
                            <option value="hutieu">Hủ tiếu</option>
                            <option value="banhcanh">Bánh canh</option>
                            <option value="phobo">Phở bò</option>
                            <option value="nui">Nui</option>
                            <option value="banhmi">Bánh mì thịt</option>
                            <option value="banhcuon">Bánh cuốn</option>
                        </select>
                    </td>
                </tr>
            </table>
        </div>

        <div class="pricing-info">
            <h4>Bảng giá món ăn:</h4>
            <p>Bún bò: 20.000₫ | Hủ tiếu: 18.000₫ | Bánh canh: 17.000₫ | Phở bò: 19.000₫</p>
            <p>Nui: 15.000₫ | Bánh mì thịt: 12.000₫ | Bánh cuốn: 15.000₫</p>
        </div>

        <div class="order-section">
            <div class="table-section">
                <h4>Bàn 1</h4>
                <div id="table1-orders"></div>
                <div id="table1-total">Tổng tiền: 0₫</div>
            </div>
            
            <div class="table-section">
                <h4>Bàn 2</h4>
                <div id="table2-orders"></div>
                <div id="table2-total">Tổng tiền: 0₫</div>
            </div>
            
            <div class="table-section">
                <h4>Bàn 3</h4>
                <div id="table3-orders"></div>
                <div id="table3-total">Tổng tiền: 0₫</div>
            </div>
        </div>

        <button class="print-btn" onclick="printInvoice()">In hóa đơn</button>
    </div>

    <script>
        const dishPrices = {
            'bunbo': 20000,
            'hutieu': 18000,
            'banhcanh': 17000,
            'phobo': 19000,
            'nui': 15000,
            'banhmi': 12000,
            'banhcuon': 15000
        };

        const dishNames = {
            'bunbo': 'Bún bò',
            'hutieu': 'Hủ tiếu',
            'banhcanh': 'Bánh canh',
            'phobo': 'Phở bò',
            'nui': 'Nui',
            'banhmi': 'Bánh mì thịt',
            'banhcuon': 'Bánh cuốn'
        };

        let orders = {
            '1': {},
            '2': {},
            '3': {}
        };

        document.getElementById('dishSelect').addEventListener('change', function() {
            const selectedDishes = Array.from(this.selectedOptions);
            const currentTable = document.getElementById('tableSelect').value;
            
            selectedDishes.forEach(option => {
                const dishId = option.value;
                const dishName = dishNames[dishId];
                const price = dishPrices[dishId];
                
                if (!orders[currentTable][dishId]) {
                    orders[currentTable][dishId] = {
                        name: dishName,
                        price: price,
                        quantity: 0
                    };
                }
                orders[currentTable][dishId].quantity++;
            });
            
            updateTableDisplay(currentTable);
        });

        function updateTableDisplay(tableNumber) {
            const container = document.getElementById(`table${tableNumber}-orders`);
            const totalElement = document.getElementById(`table${tableNumber}-total`);
            let total = 0;
            
            container.innerHTML = '';
            
            Object.keys(orders[tableNumber]).forEach(dishId => {
                const item = orders[tableNumber][dishId];
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const orderItem = document.createElement('div');
                orderItem.className = 'order-item';
                orderItem.innerHTML = `
                    <span>${item.name}</span>
                    <input type="number" value="${item.quantity}" min="1" onchange="updateQuantity('${tableNumber}', '${dishId}', this.value)">
                    <span>${item.price.toLocaleString('vi-VN')}₫</span>
                    <span>= ${itemTotal.toLocaleString('vi-VN')}₫</span>
                    <button class="delete-btn" onclick="removeItem('${tableNumber}', '${dishId}')">Xóa</button>
                `;
                container.appendChild(orderItem);
            });
            
            totalElement.textContent = `Tổng tiền: ${total.toLocaleString('vi-VN')}₫`;
        }

        function updateQuantity(tableNumber, dishId, newQuantity) {
            if (newQuantity <= 0) {
                removeItem(tableNumber, dishId);
                return;
            }
            orders[tableNumber][dishId].quantity = parseInt(newQuantity);
            updateTableDisplay(tableNumber);
        }

        function removeItem(tableNumber, dishId) {
            delete orders[tableNumber][dishId];
            updateTableDisplay(tableNumber);
        }

        function printInvoice() {
            const currentTable = document.getElementById('tableSelect').value;
            const tableOrders = orders[currentTable];
            
            if (Object.keys(tableOrders).length === 0) {
                alert('Bàn này chưa có món nào!');
                return;
            }
            
            let invoiceContent = `
                <h2>Hóa đơn</h2>
                <p><strong>Ngày hóa đơn:</strong> Thứ 2, 06/07/2020, 13:00</p>
                <p><strong>Nhân viên:</strong> Nguyễn Văn A</p>
                <p><strong>Bàn:</strong> Số ${currentTable}</p>
                <table border="1" style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <th>Món</th>
                        <th>SL</th>
                        <th>Thành Tiền</th>
                    </tr>
            `;
            
            let total = 0;
            Object.keys(tableOrders).forEach(dishId => {
                const item = tableOrders[dishId];
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                invoiceContent += `
                    <tr>
                        <td>${item.name}</td>
                        <td>${item.quantity}</td>
                        <td>${itemTotal.toLocaleString('vi-VN')}₫</td>
                    </tr>
                `;
            });
            
            invoiceContent += `
                    <tr style="font-weight: bold; background-color: #e8f5e8;">
                        <td colspan="2">Tổng tiền</td>
                        <td>${total.toLocaleString('vi-VN')}₫</td>
                    </tr>
                </table>
            `;
            
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <html>
                    <head>
                        <title>Hóa đơn bàn ${currentTable}</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            table { width: 100%; border-collapse: collapse; }
                            th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
                            th { background-color: #f2f2f2; }
                        </style>
                    </head>
                    <body>
                        ${invoiceContent}
                    </body>
                </html>
            `);
            newWindow.document.close();
        }

        // Cập nhật hiển thị khi chuyển bàn
        document.getElementById('tableSelect').addEventListener('change', function() {
            const currentTable = this.value;
            updateTableDisplay(currentTable);
        });

        // Khởi tạo hiển thị bàn 1
        updateTableDisplay('1');
    </script>
</body>
</html>
